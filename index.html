<!DOCTYPE html>

<html lang="nl">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="NTP GeoData ‚Äì overzicht van GIS-, FME-, scan- en AI-projecten met kaart en QR-codes." name="description"/>
<meta content="#00AEEF" name="theme-color"/>
<title>NTP GeoData</title>
<link href="Logo_NTP.png" rel="icon"/>
<!-- Fonts -->
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&amp;display=swap" rel="stylesheet"/>
<!-- Leaflet -->
<link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet"/>
<script defer="" src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js">

}
  window.addEventListener("click", (e) => {
    if (e.target === modal) {
      modal.style.display = "none";
    }
  });
});



<!-- QR generator -->
<script defer="" src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
<style>
    :root{
      --ntp-cyan:#00AEEF;
      --text:#0f172a;
      --muted:#475569;
      --bg:#ffffff;
      --card-border:#e5e7eb;
      --shadow:0 4px 12px rgba(0,0,0,.08);
    }
    * { box-sizing: border-box; margin:0; padding:0 }
    body{
      margin:0;
      font-family:'Roboto',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
      line-height:1.6;
    }

    .topbar{
      position:sticky;
      top:0;
      z-index:100;
      background:#fff;
      border-bottom:1px solid var(--card-border);
      box-shadow:0 2px 6px rgba(0,0,0,.04);
    }
    .topbar .brand{
      max-width:1200px;
      margin:0 auto;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      padding:1.5rem 1rem;
      text-align:center;
    }
    .brand-title .name{
      font-weight:700;
      font-size:2.2rem;
      color:var(--ntp-cyan);
      letter-spacing:.03em;
    }
    .brand-title .tag{
      font-size:1.1rem;
      color:var(--muted);
      margin-top:.25rem;
    }

    /* Hamburger menu knop */
    .hamburger {
      display: none;
      background:none;
      border:none;
      font-size:2rem;
      cursor:pointer;
      color:var(--ntp-cyan);
      padding:1rem;
    }

    .subnav{
      border-top:1px solid var(--card-border);
      background:#f9fafb;
    }

  .subnav { border-top:1px solid var(--card-border); background:#f9fafb; }
  .subnav.open {
    max-height: 500px;
    opacity: 1;
    transform: translateY(0);
  }

    .subnav .row{
      max-width:1200px;
      margin:0 auto;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:2rem;
      padding:.75rem 1rem;
      flex-wrap:wrap;
    }
    .subnav a{
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:.04em;
      color:var(--text);
      text-decoration:none;
      font-size:1rem;
      padding:.5rem .25rem;
      border-bottom:3px solid transparent;
      transition:all .2s ease;
    }
    .subnav a:hover,
    .subnav a:focus-visible{
      border-color:var(--ntp-cyan);
      color:var(--ntp-cyan);
    }

    html{scroll-behavior:smooth}
    .section{scroll-margin-top:140px; max-width:1000px; margin:0 auto; padding:4rem 1rem}
    .section h2{font-size:1.75rem; color:var(--ntp-cyan); margin-bottom:1rem}

    #projects{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
      gap:1.5rem;
      margin-top:2rem;
    }
    .card{
      background:#fff;
      border:1px solid var(--card-border);
      border-radius:14px;
      box-shadow:var(--shadow);
      overflow:hidden;
      transition:transform .2s, box-shadow .2s;
    }
    .card:hover{transform:translateY(-4px); box-shadow:0 6px 16px rgba(0,0,0,.1)}
    .card h3{
      margin:0;
      font-size:1.2rem;
      font-weight:700;
      padding:1rem;
      background:#f9fafb;
      border-bottom:1px solid var(--card-border);
    }
    .card .content{padding:1rem}
    .btn{
      display:inline-block;
      margin-top:.75rem;
      padding:.6rem 1rem;
      border-radius:8px;
      font-size:.95rem;
      font-weight:600;
      text-decoration:none;
      background:var(--ntp-cyan);
      color:#fff;
      transition:background .2s ease;
    }
    .btn:hover{background:#0095d6}
    .btn:focus-visible{box-shadow:0 0 0 3px rgba(0,174,239,.35)}
    .qr{margin-top:1rem}
    .qr canvas{display:block; margin:auto}

    #map{
      width:100%;
      height:440px;
      margin-top:2rem;
      border:1px solid var(--card-border);
      border-radius:14px;
      box-shadow:var(--shadow);
    }

    /* Contactpagina styling */
    .contact-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      max-width: 1200px;
      margin: 0 auto;
      align-items: start;
    }
    .contact-card {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      margin-bottom: 2rem;
      padding: 1.25rem;
      border-radius: 14px;
      background: #fff;
      box-shadow: var(--shadow);
      transition: transform .2s, box-shadow .2s;
    }
    .contact-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(0,0,0,.1);
    }
    .contact-card h3 {
      margin: 0;
      color: var(--ntp-cyan);
    }
    .contact-card p {
      margin: .35rem 0;
    }
    .contact-card a {
      color: var(--ntp-cyan);
      text-decoration: none;
      font-weight:500;
    }
    .contact-card a:hover {
      text-decoration: underline;
      color: #0095d6;
    }
    .locations-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-top: 1rem;
    }
    .locations-grid img {
      width: 100%;
      border-radius: 14px;
      object-fit: cover;
      border: 2px solid #f1f5f9;
      transition: transform .2s, box-shadow .2s;
    }
    .locations-grid img:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 12px rgba(0,0,0,.1);
    }
    @media (max-width: 900px) {
      .contact-grid {
        grid-template-columns: 1fr;
      }
    }


.parallax {
  background-attachment: fixed;
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
  min-height: 420px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

@media (max-width: 768px) {
  .hamburger { display:block; margin-left:auto; }
  .subnav { border-top:1px solid var(--card-border); background:#f9fafb; }
  .subnav.open {
    max-height: 500px;
    opacity: 1;
  }
  .subnav .row { flex-direction: column; gap: 0; }
  .subnav a { display:block; padding:1rem; border-bottom:1px solid var(--card-border); text-align:center; }
}
@media (max-width: 600px) {
  .locations-grid { grid-template-columns: 1fr; }
}
@media (max-width: 480px) {
  .brand-title .name { font-size:1.6rem; }
  .brand-title .tag { font-size:0.9rem; }
  .section h2 { font-size:1.4rem; }
  body { font-size:0.95rem; }
  .parallax { background-attachment:scroll; min-height:240px; }
}


/* Kalender moderner maken */
#calendar {
  margin-top: 2rem;
  border: 1px solid #e5e7eb;
  border-radius: 14px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  background: #fff;
  padding: 1rem;
}

/* Header stijlen */
.fc-toolbar-title {
  font-size: 1.4rem !important;
  font-weight: 600 !important;
  color: #00AEEF !important;
}

/* Navigatieknoppen */
.fc-button {
  background: #00AEEF !important;
  border: none !important;
  border-radius: 8px !important;
  font-weight: 500 !important;
  padding: .4rem .8rem !important;
}
.fc-button:hover {
  background: #0095d6 !important;
}

/* Dagen en cellen */
.fc-daygrid-day, .fc-timegrid-slot {
  border-color: #f1f5f9 !important;
}
.fc-col-header-cell {
  background: #f9fafb !important;
  font-weight: 600;
  color: #475569;
}

/* Events moderner */
.fc-event {
  border-radius: 6px !important;
  padding: 2px 6px !important;
  font-size: 0.85rem !important;
  font-weight: 500 !important;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}


/* Kleuren reserveringen modern pastel */
.fc-event.red, .fc-event[style*="red"] {
  background: #fca5a5 !important; /* zacht rood */
  border: none !important;
  color: #7f1d1d !important;
}
.fc-event.orange, .fc-event[style*="orange"] {
  background: #fdba74 !important; /* zacht oranje */
  border: none !important;
  color: #78350f !important;
}
.fc-event.green, .fc-event[style*="lightgreen"], .fc-event[style*="green"] {
  background: #86efac !important; /* zacht groen */
  border: none !important;
  color: #064e3b !important;
}


/* Modernere achtergrond voor de agenda */
#calendar {
  margin-top: 2rem;
  border-radius: 16px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
  background: #ffffff;
  padding: 1.5rem;
}

/* Header */
.fc-toolbar-title {
  font-size: 1.5rem !important;
  font-weight: 700 !important;
  color: #00AEEF !important;
  letter-spacing: 0.02em;
}

/* Buttons */
.fc-button {
  background: linear-gradient(135deg, #00AEEF, #0095d6) !important;
  border-radius: 10px !important;
  font-weight: 600 !important;
  padding: .5rem 1rem !important;
  transition: transform .15s ease;
}
.fc-button:hover {
  transform: translateY(-2px);
}

/* Events chip-stijl */
.fc-event {
  border-radius: 9999px !important;
  padding: 4px 10px !important;
  font-size: 0.85rem !important;
  font-weight: 600 !important;
  display: flex;
  align-items: center;
  gap: .4rem;
  transition: background .2s ease;
}
.fc-event:hover {
  filter: brightness(0.95);
}

/* Vrij (groen) */
.fc-event[style*="lightgreen"], .fc-event.green {
  background: #bbf7d0 !important;
  color: #166534 !important;
}
.fc-event[style*="lightgreen"]::before, .fc-event.green::before {
  content: "‚úÖ";
}

/* Half (oranje) */
.fc-event[style*="orange"], .fc-event.orange {
  background: #fed7aa !important;
  color: #7c2d12 !important;
}
.fc-event[style*="orange"]::before, .fc-event.orange::before {
  content: "‚ö†Ô∏è";
}

/* Vol (rood) */
.fc-event[style*="red"], .fc-event.red {
  background: #fecaca !important;
  color: #7f1d1d !important;
}
.fc-event[style*="red"]::before, .fc-event.red::before {
  content: "‚ùå";
}


/* Dark mode styling */
body.dark {
  background: #0f172a;
  color: #f1f5f9;
}
body.dark #calendar {
  background: #1e293b;
  border-color: #334155;
}
body.dark .fc-toolbar-title {
  color: #38bdf8 !important;
}
body.dark .fc-button {
  background: linear-gradient(135deg, #38bdf8, #0ea5e9) !important;
}
body.dark .fc-col-header-cell {
  background: #1e293b !important;
  color: #e2e8f0 !important;
}
body.dark .fc-event {
  box-shadow: none !important;
  opacity: 0.9;
}


/* Onbeschikbare dagen (eerste 3 dagen) */
.fc-unavailable {
  background-color: #f3f4f6 !important;
  opacity: 0.7;
  pointer-events: none; /* niet klikbaar */
}
body.dark .fc-unavailable {
  background-color: #1e293b !important;
}


.fc-unavailable::after {
  content: "üîí";
  display: block;
  text-align: center;
  font-size: 1.2rem;
  margin-top: 4px;
  color: #9ca3af;
}


/* Popup reserveringsdetails */
.reservation-modal {
  position: fixed;
  z-index: 1000;
  left: 0; top: 0;
  width: 100%; height: 100%;
  background-color: rgba(0,0,0,0.5);
  display: none;
  align-items: center; justify-content: center;
}
.reservation-content {
  background: #fff;
  padding: 2rem;
  border-radius: 12px;
  width: 400px;
  max-width: 90%;
  box-shadow: 0 10px 25px rgba(0,0,0,0.2);
  animation: fadeIn 0.3s ease;
}
body.dark .reservation-content {
  background: #1e293b;
  color: #f1f5f9;
}
.reservation-close {
  float: right;
  font-size: 1.5rem;
  cursor: pointer;
}


@keyframes popupFade {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0); }
}
.reservation-content {
  animation: popupFade 0.3s ease;
}


.reservation-btn {
  margin-top: 1rem;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 8px;
  background: #2563eb;
  color: white;
  cursor: pointer;
}
.reservation-btn:hover {
  background: #1e40af;
}


  .card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .card:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 16px rgba(0,0,0,0.15);
  }
  .qr {
    margin-top: .5rem;
    text-align: center;
    opacity: 0.5;
    transition: opacity 0.3s ease;
  }
  .qr:hover {
    opacity: 1;
  }
  .qr canvas {
    width: 60px !important;
    height: 60px !important;
    margin: 0 auto;
    display: block;
  }
  .qr small {
    display: block;
    font-size: 0.7rem;
    color: #6b7280;
    margin-top: .25rem;
  }


.parallax {min-height:500px;}
@media (max-width: 768px) {
  .parallax {min-height:300px;}
}
@media (min-width: 1200px) {
  .parallax {min-height:600px;}
}

@media (max-width: 768px) {
  .hamburger { display:block; margin-left:auto; }
  .subnav {
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    transform: translateY(-10px);
    transition: max-height 0.4s ease, opacity 0.3s ease, transform 0.3s ease;
  }
  .subnav.open {
    max-height: 500px;
    opacity: 1;
    transform: translateY(0);
  }
  .subnav .row { flex-direction: column; gap: 0; }
  .subnav a { display:block; padding:1rem; border-bottom:1px solid var(--card-border); text-align:center; }
}

</style>
<!-- FullCalendar Scheduler -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar-scheduler@6.1.8/index.global.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar-scheduler@6.1.8/index.global.min.js"></script>
<style>
    .mv-btn {
      background:#00AEEF;
      color:#fff;
      padding:.6rem 1rem;
      border-radius:8px;
      font-weight:600;
      cursor:pointer;
      border:none;
    }
    .fc-today { background:#e0f2fe !important; }
  
.parallax {min-height:500px;}
@media (max-width: 768px) {
  .parallax {min-height:300px;}
}
@media (min-width: 1200px) {
  .parallax {min-height:600px;}
}
</style>
<style>
    #agendaModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.5); align-items:center; justify-content:center; z-index:200; }
    #agendaModal .modal-content { background:#fff; padding:2rem; border-radius:12px; max-width:520px; width:90%; text-align:left; }
  
.parallax {min-height:500px;}
@media (max-width: 768px) {
  .parallax {min-height:300px;}
}
@media (min-width: 1200px) {
  .parallax {min-height:600px;}
}
</style>
<style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:0;padding:2rem}
    .mv-btn {background:#00AEEF;color:#fff;padding:.6rem 1rem;border-radius:8px;font-weight:600;cursor:pointer;border:none;}
    .fc-today { background:#e0f2fe !important; }
    #agendaModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.5); align-items:center; justify-content:center; z-index:200; }
    #agendaModal .modal-content { background:#fff; padding:2rem; border-radius:12px; max-width:520px; width:90%; text-align:left; }
  
.parallax {min-height:500px;}
@media (max-width: 768px) {
  .parallax {min-height:300px;}
}
@media (min-width: 1200px) {
  .parallax {min-height:600px;}
}
</style>
<style>
.legend {
  display: flex;
  gap: 1rem;
  margin: 1rem 0;
  font-weight: 500;
}
.legend-item {
  display: flex;
  align-items: center;
  gap: .5rem;
}
.legend-color {
  width: 18px;
  height: 18px;
  border-radius: 4px;
  display: inline-block;
}
.legend-green { background: #bbf7d0; border: 1px solid #166534; }
.legend-orange { background: #fed7aa; border: 1px solid #7c2d12; }
.legend-red { background: #fecaca; border: 1px solid #7f1d1d; }

.parallax {min-height:500px;}
@media (max-width: 768px) {
  .parallax {min-height:300px;}
}
@media (min-width: 1200px) {
  .parallax {min-height:600px;}
}
</style>
<style>
.contact-grid h3 {
  margin-top: 0;
  margin-bottom: 1rem;
  font-size: 1.4rem;
  font-weight: 600;
  color: var(--ntp-cyan);
}
</style></head>
<body>
<button class="mv-btn" id="darkModeToggle" style="position:fixed;top:1rem;right:1rem;z-index:500;">
üåô Dark Mode
</button>
<!-- Hero / Welkom sectie -->
<section class="hero" style="
  background-image:url('hearderbannerhero.jpg');
  background-size:cover;
  background-position:center;
  height:75vh;
  width:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  color:white;
  position:relative;">
<!-- donkere overlay voor leesbaarheid -->
<div style="position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.3);"></div>
<div style="position:relative;z-index:1;max-width:900px;padding:2rem;">
<h1 style="font-size:3rem;font-weight:800;margin-bottom:1.5rem;">Welkom bij NTP GeoData</h1>
<p style="font-size:1.3rem;line-height:1.6;margin-bottom:2rem;">
      Het centrale loket voor GIS, FME, Scanning, AI en maatvoering.<br/>
      Betrouwbare data, slimme tools en directe toepasbaarheid voor elk project.
    </p>
<a class="btn" href="#main" style="font-size:1.1rem;padding:1rem 2rem;">Ontdek meer</a>
</div>
</section>
<header class="topbar" role="banner">
<div aria-label="NTP GeoData" class="brand">
<img alt="NTP logo" height="60" loading="lazy" src="Logo_NTP.png" style="height:60px;margin-bottom:.5rem;" width="160"/>
<div aria-live="polite" class="brand-title">
<span class="name">NTP GeoData</span>
<span class="tag">Nauwkeurig ¬∑ Toepasbaar ¬∑ Praktisch</span>
</div>
</div>
<button aria-expanded="false" aria-label="Menu openen" class="hamburger">‚ò∞</button>
<nav aria-label="Hoofdnavigatie" class="subnav">
<div class="row">
<a href="https://ntpbv.maps.arcgis.com/home/index.html" rel="noopener noreferrer" target="_blank">GIS</a>
<a href="#fme">FME</a>
<a href="#scan">SCAN</a>
<a href="#vgis">VGIS</a>
<a href="#ai">AI</a>
<a href="#maatvoering">Maatvoering</a>
<a href="#nieuws">Nieuws</a>
<a href="#contact">Contact</a>
</div>
</nav>
</header>
<main id="main">
<section class="section" id="GIS" style="padding:4rem 1rem;text-align:center;">
<h2>GIS</h2>
<p>Stel je voor dat je niet alleen met woorden of cijfers kunt vertellen waar iets is, maar dat je het meteen op een kaart tot leven ziet komen. 
Dat is precies wat (Arc)GIS doet: het koppelt informatie aan locaties. Of het nu gaat om kabels onder de grond, een nieuwbouwproject of het plannen van onderhoud, met GIS heb je alle data overzichtelijk op √©√©n digitale kaart.
Voor een organisatie als NTP betekent dit:
Slimmer plannen van projecten (bijvoorbeeld wegwerkzaamheden of infra-onderhoud).
Direct inzicht in ondergrondse en bovengrondse data: minder verrassingen, meer effici√´ntie.
Betere samenwerking, omdat iedereen met dezelfde kaart werkt.
Kortom:
ArcGIS helpt om data niet alleen te bewaren, maar vooral om er iets mee te doen ‚Äî zodat beslissingen sneller, beter en met meer zekerheid genomen kunnen worden.</p>
</section>
<section class="parallax" style="background-image:url('voorbeeld1.jpg')"></section>
<section class="section" id="fme" style="padding:4rem 1rem;text-align:center;">
<h2>FME</h2>
<p>Data zijn er in alle soorten en maten: Excel, AutoCAD, shapefiles, databases, noem maar op. Vaak praten die bestanden niet vanzelf met elkaar ‚Äî en daar komt FME om de hoek kijken. 
        FME is de tolk en klusjesman in √©√©n: hij vertaalt, combineert en bewerkt data zodat alles netjes in hetzelfde verhaal past.
Voor NTP betekent dat:
Minder tijd kwijt aan handmatig knippen en plakken van bestanden.
Data slim omzetten en koppelen zodat projecten sneller opgestart kunnen worden.
Altijd actuele en consistente informatie beschikbaar voor iedereen in het project.
Kortom: FME maakt van een wirwar aan data een overzichtelijk geheel. Het zorgt dat data beweegt waar jij dat wilt, zodat jij je kunt richten op de inhoud van het project in plaats van op bestandsformaten.</p>
</section>
<section class="parallax" style="background-image:url('voorbeeld2.jpg')"></section>
<section class="section" id="scan" style="padding:4rem 1rem;">
<h2 style="text-align:center;"><a href="projecten.html" rel="noopener noreferrer" style="color:inherit; text-decoration:none;" target="_blank">SCAN ‚Äì Xgrid Projecten</a></h2>
<p style="max-width:800px;margin:1rem auto;text-align:center;">
    Binnen NTP beschikken we nu over de <strong>LixelKity K1</strong>, een geavanceerde handheld 3D-scanner. 
    Met dit compacte systeem brengen we locaties snel en nauwkeurig in kaart via LiDAR en panoramische camera‚Äôs. 
    Zo genereren we direct real-time, gekleurde 3D-modellen met hoge precisie ‚Äì ideaal voor onze projecten en digitale vastlegging.
  </p>
<div id="map" style="margin-top:2rem; width:100%; height:440px; border:1px solid #e5e7eb; border-radius:14px;"></div>
</section>
<script>
async function loadProjects() {
  try {
    const resp = await fetch("https://script.google.com/macros/s/AKfycbyPJJMiLM4yypa_YsV0zhwJYQSSr4wOLQuxrY7WIu4CVzcxf5SDVHdQVRd9NQTQUus9JQ/exec");
    return await resp.json();
  } catch (err) {
    console.error("Fout bij laden projecten:", err);
    return [];
  }
}

document.addEventListener("DOMContentLoaded", async function() {
  if (typeof L === "undefined") return;
  const map = L.map("map").setView([52.15, 5.3], 8);

  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    maxZoom: 19,
    attribution: "&copy; OpenStreetMap-bijdragers"
  }).addTo(map);

  const projects = await loadProjects();
  projects.forEach(row => {
    if (row.lat && row.lng) {
      const title = `${row.projectnummer || ""} ${row.projectnaam || ""} ${row.scannummer || ""}`;
      let popup = `<b>${title}</b><br><a href="${row.url}" target="_blank">Open project</a>`;
      if (row.password) popup += `<br><small>Wachtwoord: ${row.password}</small>`;
      L.marker([parseFloat(row.lat), parseFloat(row.lng)]).addTo(map).bindPopup(popup);
    }
  });
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  if (typeof L === "undefined") return;
  const map = L.map("map").setView([52.15, 5.3], 8); // Midden NL

  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    maxZoom: 19,
    attribution: "&copy; OpenStreetMap-bijdragers"
  }).addTo(map);

  // Voorbeeld marker
  L.marker([52.15, 5.3]).addTo(map)
    .bindPopup("Voorbeeld: NTP GeoData")
    .openPopup();
});
</script>
<section class="parallax" style="background-image:url('voorbeeld3.jpg')"></section>
<section class="section" id="vgis" style="padding:4rem 1rem;text-align:center;">
<h2>VGIS</h2>
<p>VGIS(Vsite) is een platform dat je ruimtelijke data (GIS, CAD, 3D-scans, KLIC-data.) omzet in visuele, augmented reality‚Äìondersteunde inzichten, zodat wat normaliter op een plat of abstract kaartje staat, bijna letterlijk zichtbaar wordt op de plek waar je staat.
Waarom vGIS interessant voor NTP
‚Ä¢	Veiligheid en risicovermindering: Minder kans op ongelukken of schade aan bestaande infrastructuur (leidingen, kabels) als je vooraf precies kunt zien waar ze liggen.
‚Ä¢	Effici√´ntie bij projecten: Je bespaart tijd in planning, uitvoering en documentatie, omdat minder gecontroleerd hoeft te worden, en fouten eerder worden opgespoord.
‚Ä¢	Betere samenwerking: Iedereen (kantoor, uitvoerder, onderaannemers) werkt met dezelfde actuele informatie en visualisaties, minder verwarring.
‚Ä¢	Hogere kwaliteit van documentatie: As-built tekeningen zijn nauwkeuriger, vollediger, sneller beschikbaar. Nuttig voor latere fasen (onderhoud, inspectie).
</p>
</section>
<section class="parallax" style="background-image:url('voorbeeld4.jpg')"></section>
<section class="section" id="ai" style="padding:4rem 1rem;text-align:center;">
<h2>AI</h2>
<p>Ook binnen NTP willen we de kracht van <strong>Artificial Intelligence (AI)</strong> benutten om onze processen slimmer en effici√´nter te maken. 
  Denk aan automatische patroonherkenning in geo-data, voorspellingen voor planning en onderhoud, of het sneller verwerken van grote hoeveelheden projectinformatie. 
  AI helpt ons om niet alleen reactief maar ook proactief te werken: problemen eerder signaleren, kansen sneller benutten en onze projecten aantoonbaar duurzamer en veiliger uit te voeren.</p>
<p>De komende periode verkennen we verschillende toepassingen en bouwen we pilots, zodat AI stap voor stap een vast onderdeel wordt van onze werkprocessen.</p>
<div style="margin-top:2rem;">
<h3>
<img alt="Telraam logo" src="telraam_logo.png" style="height:28px;vertical-align:middle;margin-right:8px;opacity:0.8;"/>
    Telraam Dashboard
  </h3>
<iframe loading="lazy" src="https://telraam.net/nl#14/52.1779/5.4681" style="width:100%;height:600px;border:1px solid #e5e7eb;
           border-radius:14px;box-shadow:0 4px 12px rgba(0,0,0,.08);">
</iframe>
<div style="max-width:800px;margin:1.5rem auto;padding:1rem;
              border:1px solid #e5e7eb;border-radius:12px;
              background:#f9fafb;color:#475569;font-size:0.95rem;">
<strong>Telraam</strong> is een innovatief platform dat gebruikmaakt van AI 
    om voertuigen automatisch te herkennen en te tellen. Met behulp van sensoren 
    en beeldherkenning worden verkeersstromen geanalyseerd, waardoor betrouwbare 
    data beschikbaar komt voor onderzoek, beleid en projectplanning. 
    Deze toepassing laat zien hoe AI concreet kan bijdragen aan slimme mobiliteitsoplossingen.
  </div>
</div>
</section>
<section class="parallax" style="background-image:url('voorbeeld5.jpg');min-height:500px;"></section>
<section class="section" id="maatvoering"><h2>Maatvoering</h2>
<p>
Via deze website kun je eenvoudig de planning voor maatvoering bekijken en een landmeter reserveren. Houd er rekening mee dat reserveren pas mogelijk is vanaf 3 dagen na vandaag.
</p>
<p>
Binnen NTP hebben we een beperkt aantal maatvoerders/landmeters die een belangrijke rol vervullen bij onze projecten. Om hun inzet zo effici√´nt mogelijk te benutten, plannen we gestructureerd. Dit betekent dat niet alleen de werkzaamheden op locatie worden ingepland, maar ook tijd voor voorbereiding en verwerking. Zo zorgen we samen voor kwaliteit en continu√Øteit in de uitvoering.
</p>
<p>Onderstaande kalender geeft de actuele beschikbaarheid weer:</p>
<div class="legend">
<div class="legend-item"><span class="legend-color legend-green"></span> Groen = volledig beschikbaar</div>
<div class="legend-item"><span class="legend-color legend-orange"></span> Oranje = nog √©√©n dagdeel beschikbaar</div>
<div class="legend-item"><span class="legend-color legend-red"></span> Rood = niet meer beschikbaar</div>
</div>
<div id="calendar"></div>
<button class="mv-btn" onclick="MaatvoeringCalendar.openAgenda()" style="margin-top:20px;">Reserveer landmeter</button><div id="statusMsg" style="margin:10px; font-weight:bold;"></div><div id="agendaModal">
<div class="modal-content">
<h3 style="margin-top:0;color:#00AEEF;">Reserveer een landmeter</h3>
<form id="agendaForm">
<label for="datum">Datum:</label><br/>
<input id="datum" name="datum" required="" type="date"/><br/>
<label for="landmeter">Landmeter:</label><br/>
<select id="landmeter" name="landmeter" required="">
<option value="">-- kies --</option>
<option value="lm1">Landmeter 1</option>
<option value="lm2">Landmeter 2</option>
<option value="lm3">Landmeter 3</option>
</select><br/>
<label for="tijd">Tijd:</label><br/>
<select id="tijd" name="tijd" required="">
<option value="">-- kies --</option>
<option value="morning">07:00 - 11:00</option>
<option value="afternoon">12:00 - 16:00</option>
<option value="fullday">Hele dag</option>
</select><br/>
<label for="werkzaamheden">Werkzaamheden:</label><br/>
<input id="werkzaamheden" name="werkzaamheden" required="" type="text"/><br/>
<label for="project">Project:</label><br/>
<input id="project" name="project" required="" type="text"/><br/>
<label for="email">E-mail:</label><br/>
<input id="email" name="email" required="" type="email"/><br/><br/>
<button class="mv-btn" type="submit">Reserveer</button>
<button class="mv-btn" onclick="MaatvoeringCalendar.closeAgenda()" style="background:#ccc;color:#000;" type="button">Sluiten</button>
</form>
</div>
</div></section>
<section class="section" id="nieuws" style="padding:4rem 1rem;">
<h2>Nieuws</h2>
<p><strong>Hoevelaken, 3 september 2025</strong> ‚Äî NTP introduceert <strong>NTP GeoData</strong>, 
  een nieuwe afdeling die als spil fungeert voor alles wat met geo-data, kaarten en ruimtelijke analyses te maken heeft. 
  Met NTP GeoData zet NTP een volgende stap in digitale vernieuwing en ondersteunt het teams bij het sneller, slimmer en veiliger uitvoeren van projecten.</p>
<h3>Waarom NTP GeoData?</h3>
<p>Steeds meer werkprocessen bij NTP leunen op geografische informatie: van ontwerp en planning tot uitvoering en beheer. 
  NTP GeoData combineert expertise in geo-data met praktische tools, zodat collega‚Äôs √©√©n aanspreekpunt hebben voor betrouwbare kaarten, analyses en datagedreven besluitvorming.</p>
<h3>Wat doet NTP GeoData concreet?</h3>
<ul style="text-align:left;max-width:800px;margin:1rem auto;">
<li><strong>Datavoorziening &amp; beheer</strong>: opzetten en beheren van centrale geo-datasets, inclusief kwaliteitsborging en versiebeheer.</li>
<li><strong>Analyses &amp; voorbereiding visualisaties</strong>: ruimtelijke analyses, dashboards en interactieve kaartviews voor tender, voorbereiding en uitvoering.</li>
<li><strong>Innovatie R&amp;D</strong>: verkennen en pilotten van nieuwe technieken (o.a. LiDAR, reality capture, AI-interpretatie, sensordata).</li>
<li><strong>Procesintegratie</strong>: koppelingen met bestaande systemen (BIM, planning, assetmanagement) en standaardisatie van werkafspraken.</li>
<li><strong>Support &amp; training</strong>: helpdesk, korte instructies en verdiepingstrainingen voor projectteams.</li>
</ul>
<blockquote style="font-style:italic;margin:2rem auto;max-width:800px;">
    ‚ÄúMet NTP GeoData brengen we geo-kennis en innovatieve tooling dicht bij de werkvloer. 
    Dat levert tijdwinst op, vermindert faalkosten en maakt onze projecten aantoonbaar duurzamer,‚Äù 
    aldus <strong>[Bjorn Wunderink]</strong>.
  </blockquote>
<h3>Voor wie?</h3>
<p>Alle NTP-collega‚Äôs die werken met locatiegebonden informatie: tender- en projectleiders, 
  uitvoerders, werkvoorbereiders, ontwerpers en assetmanagers.</p>
</section>
<!-- Gestylede contactsectie -->
<!-- Gestylede contactsectie -->
<!-- Gestylede contactsectie -->
<section id="contact" style="padding:4rem 0; background:#fffde7; width:100%;">
<div class="section">
<h2 style="text-align:center;margin-bottom:2rem;">Contact</h2>
<div class="contact-grid">
<!-- Teamleden -->
<div><h3>Onze specialisten</h3>
<article class="contact-card">
<img alt="Bj√∂rn Wunderink" src="bjorn.png" style="width:120px;height:120px;object-fit:cover;border-radius:12px;"/>
<div>
<h3>Bj√∂rn Wunderink</h3>
<p><strong>Specialist Geo Data</strong></p>
<p>
<a href="mailto:b.wunderink@ntp.nl">b.wunderink@ntp.nl</a><br/>
<a href="tel:+31610740548">+31 6 10740548</a>
</p>
</div>
</article>
<article class="contact-card">
<img alt="Thijs van der Pal" src="Thijs.png" style="width:120px;height:120px;object-fit:cover;border-radius:12px;"/>
<div>
<h3>Thijs van der Pal</h3>
<p><strong>Specialist GIS Geodata</strong></p>
<p>
<a href="mailto:t.vanderpal@ntp.nl">t.vanderpal@ntp.nl</a><br/>
<a href="tel:+31657404089">+31 6 57404089</a>
</p>
</div>
</article>
<article class="contact-card">
<img alt="Dirk Bakker" src="Dirk.png" style="width:120px;height:120px;object-fit:cover;border-radius:12px;"/>
<div>
<h3>Dirk Bakker</h3>
<p><strong>Specialist FME Geodata</strong></p>
<p>
<a href="mailto:d.bakker@ntp.nl">d.bakker@ntp.nl</a><br/>
<a href="tel:+31651033684">+31 6 51033684</a>
</p>
</div>
</article>
</div>
<!-- Locaties -->
<div>
<h3 style="margin-top:0;">Onze locaties</h3>
<div class="locations-grid">
<!-- Midden -->
<div class="contact-card" style="flex-direction:column;align-items:center;text-align:center;">
<img alt="NTP Midden" src="loc1.png" style="width:100%;border-radius:14px;margin-bottom:1rem;"/>
<h3>NTP Midden</h3>
<p>üìû <a href="tel:+31384441681">+31 (0)384441681</a></p>
<p>‚úâÔ∏è <a href="mailto:midden@ntp.nl">midden@ntp.nl</a></p>
<p>üìç <a href="https://maps.google.com?q=Utrecht" target="_blank">Plan route</a></p>
</div>
<!-- Hattem -->
<div class="contact-card" style="flex-direction:column;align-items:center;text-align:center;">
<img alt="NTP Hattem" src="loc2.png" style="width:100%;border-radius:14px;margin-bottom:1rem;"/>
<h3>NTP Hattem</h3>
<p>üìû <a href="tel:+31384441681">+31 (0)384441681</a></p>
<p>‚úâÔ∏è <a href="mailto:hattem@ntp.nl">hattem@ntp.nl</a></p>
<p>üìç <a href="https://maps.google.com?q=Hattem" target="_blank">Plan route</a></p>
</div>
<!-- Enschede -->
<div class="contact-card" style="flex-direction:column;align-items:center;text-align:center;">
<img alt="NTP Enschede" src="loc3.png" style="width:100%;border-radius:14px;margin-bottom:1rem;"/>
<h3>NTP Enschede</h3>
<p>üìû <a href="tel:+31534614411">+31 (0)534614411</a></p>
<p>‚úâÔ∏è <a href="mailto:enschede@ntp.nl">enschede@ntp.nl</a></p>
<p>üìç <a href="https://maps.google.com?q=Enschede" target="_blank">Plan route</a></p>
</div>
<!-- Zevenaar -->
<div class="contact-card" style="flex-direction:column;align-items:center;text-align:center;">
<img alt="NTP Zevenaar" src="loc4.png" style="width:100%;border-radius:14px;margin-bottom:1rem;"/>
<h3>NTP Zevenaar</h3>
<p>üìû <a href="tel:+31313478587">+31 (0)313478587</a></p>
<p>‚úâÔ∏è <a href="mailto:zevenaar@ntp.nl">zevenaar@ntp.nl</a></p>
<p>üìç <a href="https://maps.google.com?q=Zevenaar" target="_blank">Plan route</a></p>
</div>
</div>
</div>
</div>
</div>
</section>
</main>
<script>

    let projects = [];

    async function loadProjects() {
      try {
        const resp = await fetch("https://script.google.com/macros/s/AKfycbyPJJMiLM4yypa_YsV0zhwJYQSSr4wOLQuxrY7WIu4CVzcxf5SDVHdQVRd9NQTQUus9JQ/exec");
        const data = await resp.json();
        return data.map(row => {
          const nr = row.projectnummer?.toString().trim() || "";
          const nm = (row.projectnaam || "").toString().trim().replace(/\s+/g, '_');
          const sn = row.scannummer?.toString().trim() || "";
          const title = `${nr}_${nm}_${sn}`;
          return {
            id: title.toLowerCase().replace(/[^a-z0-9\-_]/g, '-'),
            title: title,
            url: row.url,
            lat: parseFloat(row.lat),
            lng: parseFloat(row.lng),
            password: row.password || null
          };
        });
      } catch (err) {
        console.error("Fout bij laden projecten:", err);
        return [];
      }
    }

    function createProjectCard(p) {
      const card = document.createElement("article");
      card.className = "card";
      card.setAttribute("aria-labelledby", `h-${p.id}`);
      card.innerHTML = `
        <h3 id="h-${p.id}">${p.title}</h3>
        <div class="content">
          <a class="btn" href="${p.url}" target="_blank" rel="noopener noreferrer">Openen</a>
          ${p.password ? `<p><small>Wachtwoord: ${p.password}</small></p>` : ""}
          <div class="qr"><canvas id="qr-${p.id}"></canvas></div>
        </div>`;
      return card;
    }

    function renderProjects(){ return; }
// originele functie uitgeschakeld {
      const container = document.getElementById("projects");
      container.innerHTML = "";
      projects.forEach(p => {
        const card = createProjectCard(p);
        container.appendChild(card);
        if (typeof QRious !== "undefined") {
          new QRious({
            element: document.getElementById(`qr-${p.id}`),
            value: p.url,
            size: 40,
            foreground: "#00AEEF"
          });
        }
      });
    }

    function initMap() {
      const el = document.getElementById("map");
      if (typeof L === "undefined" || !el) return;
      const map = L.map(el, { scrollWheelZoom: true }).setView([52.15, 5.3], 8);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19,
        attribution: "&copy; OpenStreetMap-bijdragers"
      }).addTo(map);
      projects.forEach(p => {
        if (p.lat && p.lng) {
          const m = L.marker([p.lat, p.lng]).addTo(map);
          let popup = `<b>${p.title}</b><br><a href="${p.url}" target="_blank">Open project</a>`;
          if (p.password) popup += `<br><small>Wachtwoord: ${p.password}</small>`;
          m.bindPopup(popup);
        }
      });
    }

    document.addEventListener("DOMContentLoaded", async () => {
      projects = await loadProjects();
      renderProjects();
      initMap();
    });
  
</script>
<div id="agendaModal">
<div class="modal-content">
<h3 style="margin-top:0;color:#00AEEF;">Reserveer een landmeter</h3>
<form id="agendaForm">
<label for="datum">Datum:</label><br/>
<input id="datum" required="" style="margin:.5rem 0;width:100%;padding:.5rem;" type="date"/><br/>
<label for="landmeter">Landmeter:</label><br/>
<select id="landmeter" required="" style="margin:.5rem 0;width:100%;padding:.5rem;">
<option value="">-- kies --</option>
<option value="lm1">Landmeter 1</option>
<option value="lm2">Landmeter 2</option>
<option value="lm3">Landmeter 3</option>
</select><br/>
<label for="tijd">Tijd:</label><br/>
<select id="tijd" required="" style="margin:.5rem 0;width:100%;padding:.5rem;">
<option value="">-- kies --</option>
<option value="morning">07:00 - 11:00</option>
<option value="afternoon">12:00 - 16:00</option>
<option value="fullday">Hele dag</option>
</select><br/>
<label for="werkzaamheden">Werkzaamheden:</label><br/>
<input id="werkzaamheden" required="" style="margin:.5rem 0;width:100%;padding:.5rem;" type="text"/><br/>
<label for="project">Project:</label><br/>
<input id="project" required="" style="margin:.5rem 0;width:100%;padding:.5rem;" type="text"/><br/><br/>
<button class="mv-btn" type="submit">Reserveer</button>
<button class="mv-btn" onclick="MaatvoeringCalendar.closeAgenda()" style="background:#ccc;color:#000;" type="button">Sluiten</button>
</form>
</div>
</div>
<script>
const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxgpINoQNego19_BUVerkt65oTiLfrQ91gCrXe9vc3MSBsRRrAx0IZlONksxEIqEi-FNQ/exec";

window.MaatvoeringCalendar = (function(){

    let reservations = { lm1:{}, lm2:{}, lm3:{} };
    let calendar;

    function buildBaseGreenEvents(){
      const events = [];
      const today = new Date();
      const end = new Date(today);
      end.setMonth(end.getMonth()+3);

      for(let d=new Date(today); d<=end; d.setDate(d.getDate()+1)){
        const key = d.toISOString().split("T")[0];
        ["lm1","lm2","lm3"].forEach(lm => {
          events.push({
            start: key+"T07:00:00",
            end: key+"T16:00:00",
            resourceId: lm,
            color: "lightgreen",
            display: "background"
          });
        });
      }
      return events;
    }

    function buildReservationEvents(){
      const events = [];
      for(const lm in reservations){
        for(const date in reservations[lm]){
          const r = reservations[lm][date];
          if(r.morning && r.afternoon){
            events.push({ start: date+"T07:00:00", end: date+"T16:00:00", resourceId: lm, color: "red", title: "Reservering", landmeter: lm, project: r.project, werkzaamheden: r.werkzaamheden, tijd: "Hele dag" });
          } else if(r.morning){
            events.push({ start: date+"T07:00:00", end: date+"T11:00:00", resourceId: lm, color: "orange", title: "Reservering", landmeter: lm, project: r.project, werkzaamheden: r.werkzaamheden, tijd: "07:00-11:30" });
          } else if(r.afternoon){
            events.push({ start: date+"T12:00:00", end: date+"T16:00:00", resourceId: lm, color: "orange", title: "Reservering", landmeter: lm, project: r.project, werkzaamheden: r.werkzaamheden, tijd: "11:30-16:00" });
          }
        }
      }
      return events;
    }

    function renderCalendar(){
      const today = new Date();
      const end = new Date(today);
      end.setMonth(end.getMonth()+3);

      const calendarEl = document.getElementById('calendar');
      if(calendar) calendar.destroy();
      calendar = new FullCalendar.Calendar(calendarEl, {
        schedulerLicenseKey: 'CC-Attribution-NonCommercial-NoDerivatives',
        initialView: 'resourceTimelineMonth',
        initialDate: today,
        locale: 'nl',
        weekNumbers: true,
        resourceAreaHeaderContent: 'Landmeters',
        slotLabelFormat: [{ weekday: 'long', day: 'numeric', month: 'short' }],
        nowIndicator: true,
        resources: [
    { id: 'lm1', title: 'Landmeter 1' },
    { id: 'lm2', title: 'Landmeter 2' },
    { id: 'lm3', title: 'Landmeter 3' }
  ],
  events: [...buildBaseGreenEvents(), ...buildReservationEvents()],
  eventClick: function(info){
    const ev = info.event.extendedProps || {};

    if(ev.beschikbaar){
      // Beschikbaar blok ‚Üí direct reserveringsformulier openen
      const dateStr = info.event.startStr.split("T")[0];
      const dateInput = document.getElementById("datum");
      if(dateInput){ dateInput.value = dateStr; }

      const tijdSelect = document.getElementById("tijd");
      if(tijdSelect && ev.tijd){
        if(tijdSelect.querySelector(`option[value="${ev.tijd}"]`)){
          tijdSelect.value = ev.tijd;
        }
      }

      const agendaModal = document.getElementById("agendaModal");
      if(agendaModal){ agendaModal.style.display = "flex"; }
    } else {
      // Echte reservering ‚Üí detail popup
      document.getElementById("resLandmeter").textContent = ev.landmeter || "-";
      document.getElementById("resTijd").textContent = ev.tijd || "-";
      document.getElementById("resProject").textContent = ev.project || "-";
      document.getElementById("resWerkzaamheden").textContent = ev.werkzaamheden || "-";
      document.getElementById("reservationModal").style.display = "flex";
    }
  },
  dateClick: function(info) {
    const day = new Date(info.dateStr).getDay();
    const minDate = new Date();
    minDate.setDate(minDate.getDate()+3);
    if(day === 0 || day === 6 || new Date(info.dateStr) < minDate){
      return;
    }
    // Vul datum in formulier en toon agendaModal
    const dateInput = document.getElementById("datum");
    if(dateInput){ dateInput.value = info.dateStr; }
    const agendaModal = document.getElementById("agendaModal");
    if(agendaModal){ agendaModal.style.display = "flex"; }
  },
  height: 'auto',
    dayCellDidMount: function(info) {
      const minDate = new Date();
      minDate.setDate(minDate.getDate()+3);
      const cellDate = new Date(info.date);
      const day = cellDate.getDay(); // 0=zo, 6=za
      if(cellDate < minDate || day === 0 || day === 6){
        info.el.classList.add("fc-unavailable");
      }
    }
      });
      calendar.render();
    }

    function openAgenda(){ document.getElementById("agendaModal").style.display="flex"; }
    function closeAgenda(){ document.getElementById("agendaModal").style.display="none"; }

    document.addEventListener("DOMContentLoaded",()=>{
      loadReservations();
      renderCalendar();

      document.getElementById("agendaForm").addEventListener("submit", async function(e){
        e.preventDefault();
        const datum=document.getElementById("datum").value;
        // Extra validatie: pas reserveren vanaf 3 dagen vooruit
        const selDate = new Date(datum);
        const minDate = new Date();
        minDate.setDate(minDate.getDate()+3);
        if(selDate < minDate){
          alert("Je kunt pas reserveren vanaf " + minDate.toISOString().split("T")[0]);
          return;
        }

        const landmeter=document.getElementById("landmeter").value;
        const tijd=document.getElementById("tijd").value;
        const werk=document.getElementById("werkzaamheden").value;
        const project=document.getElementById("project").value;
        const email=document.getElementById("email").value;

        if(!reservations[landmeter][datum]) reservations[landmeter][datum]={};
        if(tijd==="morning") reservations[landmeter][datum].morning=true;
        if(tijd==="afternoon") reservations[landmeter][datum].afternoon=true;
        if(tijd==="fullday"){ reservations[landmeter][datum].morning=true; reservations[landmeter][datum].afternoon=true; }

        reservations[landmeter][datum].project = project;
        reservations[landmeter][datum].werkzaamheden = werk;
        reservations[landmeter][datum].email = email;
        reservations[landmeter][datum].tijd = tijd;

        alert(`‚úÖ ${landmeter} gereserveerd op ${datum} (${tijd}) voor project "${project}" (${werk}).\nContact: ${email}`);

        renderCalendar();

        try {
          const resp = await fetch(APPS_SCRIPT_URL, {
            method: "POST",
            headers: { "Content-Type": "text/plain;charset=utf-8" },
            body: JSON.stringify({ datum, landmeter, tijd, werkzaamheden: werk, project, email })
          });
          console.log("POST status", resp.status);
        } catch(err){
          console.error("POST fout", err);
        }

        loadReservations();
        MaatvoeringCalendar.closeAgenda();
      });
    });

    async function loadReservations(){
      try{
        const r = await fetch(APPS_SCRIPT_URL);
        const data = await r.json();
    console.log('üì• JSON ontvangen van Apps Script:', data.map(d => d.datum));
        reservations = { lm1:{}, lm2:{}, lm3:{} };
        data.forEach(row => {
          const lm = row.landmeter;
          const d = new Date(row.datum);
      const date = d.getFullYear() + "-" +
                   String(d.getMonth()+1).padStart(2,"0") + "-" +
                   String(d.getDate()).padStart(2,"0"); // lokale tijd yyyy-MM-dd
          if(!lm || !date) return;
          if(!reservations[lm]) reservations[lm] = {};
          if(!reservations[lm][date]) reservations[lm][date] = {};
          const tijdTxt = (row.tijd || "").toLowerCase();

      if (tijdTxt.includes("full") || tijdTxt.includes("hele") || tijdTxt.includes("dag")) {
        reservations[lm][date].morning = true;
        reservations[lm][date].afternoon = true;
      } else if (tijdTxt.includes("morning")) {
        reservations[lm][date].morning = true;
      } else if (tijdTxt.includes("afternoon")) {
        reservations[lm][date].afternoon = true;
      } else if (tijdTxt.includes("07:00")) {
        reservations[lm][date].morning = true;
      } else if (tijdTxt.includes("12:00")) {
        reservations[lm][date].afternoon = true;
      } else if((row.tijd||"").includes("07:00")){
            reservations[lm][date].morning=true;
          } else if((row.tijd||"").includes("12:00")){
            reservations[lm][date].afternoon=true;
          }
          reservations[lm][date].project = row.project;
          reservations[lm][date].werkzaamheden = row.werkzaamheden;
          reservations[lm][date].email = row.email;
          reservations[lm][date].tijd = row.tijd;
        });
        renderCalendar();
      } catch(err){
        console.error("Fout bij laden reserveringen:", err);
      }
    }

return { openAgenda, closeAgenda };
})();
</script>


<script>
document.addEventListener("DOMContentLoaded", function(){
  const hamburger = document.querySelector(".hamburger");
  const nav = document.querySelector(".subnav");

  // Hamburger toggle met icoon wissel
  hamburger.addEventListener("click", function(){
    const isOpen = nav.classList.toggle("open");
    hamburger.setAttribute("aria-expanded", isOpen);
    hamburger.textContent = isOpen ? "‚úñ" : "‚ò∞";
  });

  // Automatisch sluiten bij klik op link (met vertraging)
  nav.querySelectorAll("a").forEach(link => {
    link.addEventListener("click", function(){
      setTimeout(() => {
        nav.classList.remove("open");
        hamburger.setAttribute("aria-expanded", "false");
        hamburger.textContent = "‚ò∞";
      }, 200);
    });
  });
});
</script>


<script>
document.addEventListener("DOMContentLoaded", function(){
  const toggleBtn = document.getElementById("darkModeToggle");
  toggleBtn.addEventListener("click", function(){
    document.body.classList.toggle("dark");
    toggleBtn.textContent = document.body.classList.contains("dark") ? "‚òÄÔ∏è Light Mode" : "üåô Dark Mode";
  });
});
</script>
<div class="reservation-modal" id="reservationModal">
<div class="reservation-content">
<span class="reservation-close" id="reservationClose">√ó</span>
<h2>Reserveringsdetails</h2>
<p><strong>Landmeter:</strong> <span id="resLandmeter"></span></p>
<p><strong>Tijd:</strong> <span id="resTijd"></span></p>
<p><strong>Project:</strong> <span id="resProject"></span></p>
<p><strong>Werkzaamheden:</strong> <span id="resWerkzaamheden"></span></p>
</div>
</div>
<script>
document.addEventListener("DOMContentLoaded", function(){
  function closeThisModal(modal){
    if(modal){ modal.style.display = "none"; }
  }
  function wireModal(modal){
    if(!modal) return;
    const xBtn = modal.querySelector("#reservationClose");
    const bottomBtn = modal.querySelector("#reservationCloseBtn");
    if(xBtn){ xBtn.addEventListener("click", () => closeThisModal(modal)); }
    if(bottomBtn){ bottomBtn.addEventListener("click", () => closeThisModal(modal)); }
    window.addEventListener("click", (e) => { if(e.target === modal){ closeThisModal(modal); } });
  }
  document.querySelectorAll("#reservationModal").forEach(wireModal);
});
</script>
</body>
</html>
